<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Chombo_4: Chombo_LoadBalance.H Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Chombo_4
   &#160;<span id="projectnumber">4586</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fed316ab17bc95342959389c6cfba126.html">BoxTools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Chombo_LoadBalance.H</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Chombo__LoadBalance_8H.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifdef CH_LANG_CC</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *      _______              __</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *     / ___/ /  ___  __ _  / /  ___</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *    / /__/ _ \/ _ \/  V \/ _ \/ _ \</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *    \___/_//_/\___/_/_/_/_.__/\___/</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *    Please refer to Copyright.txt, in Chombo&#39;s root directory.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Purpose:</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//  LoadBalance() is a global function to compute an assignment</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//  of boxes to processors for an AMR mesh hierarchy.  The assignment</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//  is made so as to balance the computation and communication</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//  workload on each processor (i.e. make it as even as possible).</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//  CAVEAT: this version ignores the communication workload.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//          It balances ONLY the compute workload.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Usage:</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//  The meshes in the AMR hierarchy are represented using</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//   a std::vector of std::vectors of Boxes.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//  The computational workload is a real number for each box in the</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//   hierarchy, also represented as a std::vector of std::vectors.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//  The communication workload is a real number for each connection</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//   between pairs of boxes, which specifies the cost of communication</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//   between the two boxes if they are on different processors.  No</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//   allowance is made for varying the communication cost depending on the</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//   distance between processors (ie. all processors are equally far apart)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//   and it assumes that the effective cost of communicating between two</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//   boxes on the same processor is zero.  The communication workload is</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//   represented as a graph.</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//  CAVEAT: the communication workload argument is not</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//           present in this version of the function.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//  The resulting assignment is an integer for each box in the hierarchy,</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//   which gives the processor number (starting at zero) on which each box</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//   should reside.  Again, represented as a std::vector of std::vectors.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//  The other output argument is the efficiency ratio, which is a measure</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//   of how close to perfect the final load balance is.  The \var{effRatio}</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//   output variable is defined as the smallest load on any processor divided</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//   by the largest load.  A perfect load balance has efficiency == 1.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//  CAVEAT: in this version, each level in the AMR hierarchy</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//          is balanced independently, so the efficiency ratio</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//          that is returned is the worst over all levels.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//  It is important to note that it is the sum of the computation cost</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//   and communication cost that is balanced, so the values in the two</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//   variables must be in the same units.  It doesn&#39;t matter what the</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//   units are.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//  CAVEAT: the communication workload argument is not</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//           present in this version of the function.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//  ********************************************************</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// Interface Specification:</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//  int LoadBalance() arguments are:</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//       std::vector&lt;std::vector&lt;int&gt;&gt;&amp; procAssignments  //output: processor number</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//                                             //   for each box</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//       Real&amp;                effRatio         //output: efficiency ratio</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// const std::vector&lt;std::vector&lt;Box&gt;&gt;&amp; Grids            //input: meshes to balance</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// const std::vector&lt;std::vector&lt;long&gt;&gt;&amp;ComputeLoads     //input: computational cost</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//                                             //   of each box</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//###not used###</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//### const [...something...]&amp;CommunicateLoads //input: communication cost</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//                                             //   between each pair of</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//                                             //   neighboring boxes</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// const std::vector&lt;int&gt;&amp;         RefRatios        //input: refinement ratio</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//                                             //   for each level</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// Returns: integer status_code</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//    =0  means succesful completion</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//  exceptions: (output variables are not defined)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//  -1011 input vectors (\var{Grids} and \var{ComputeLoads}) are not</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//        the same size</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//  -1012 one of the vector elements of the input vectors (\var{Grids}</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//        and \var{ComputeLoads}) are not the same size</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//  -1013 input vectors (\var{Grids} and \var{RefRatios}) are not</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//        the same size</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// Modification History</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//  19Nov99 &lt;dbs&gt; initial design and coding</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#ifndef _Chombo_LOADBALANCE_H_</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="Chombo__LoadBalance_8H.html#ab7ac3885ffb66ce84439d850c1d2e48a">   98</a></span>&#160;<span class="preprocessor">#define _Chombo_LOADBALANCE_H_</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__SPACE_8H.html">Chombo_SPACE.H</a>&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__REAL_8H.html">Chombo_REAL.H</a>&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__Box_8H.html">Chombo_Box.H</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__BoxLayout_8H.html">Chombo_BoxLayout.H</a>&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__SPMD_8H.html">Chombo_SPMD.H</a>&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__NamespaceHeader_8H.html">Chombo_NamespaceHeader.H</a>&quot;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span><span class="comment">/**</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">   procAssignments  output: processor number for each box</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">   effRatio         output: ratio of min load to max load</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">   Grids            input: meshes to balance</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">   ComputeLoads     input: computational cost of each box</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">   RefRatios        input: refinement ratio for each level</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>( std::vector&lt;std::vector&lt;int&gt; &gt;&amp;         a_procAssignments</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;             ,<a class="code" href="Chombo__REAL_8H.html#a445a5f0e2a34c9d97d69a3c2d1957907">Real</a>&amp;                        a_effRatio</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;             ,<span class="keyword">const</span> std::vector&lt;std::vector&lt;Box&gt; &gt;&amp;  a_Grids</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;             ,<span class="keyword">const</span> std::vector&lt;std::vector&lt;long&gt; &gt;&amp; a_ComputeLoads</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;             ,<span class="keyword">const</span> std::vector&lt;int&gt;&amp;           a_RefRatios</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;             ,<span class="keywordtype">int</span> a_nProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>()</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;             ) ;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span><span class="comment">/**</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">Grids            in-out: input grids to balance and output proc. numbers</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">effRatio         output: ratio of min load to max load</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">ComputeLoads     input: computational cost of each box</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">RefRatios        input: refinement ratio for each level</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>( std::vector&lt;BoxLayout&gt;&amp;    Grids</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;             ,<a class="code" href="Chombo__REAL_8H.html#a445a5f0e2a34c9d97d69a3c2d1957907">Real</a>&amp;                 effRatio</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;             ,<span class="keyword">const</span> std::vector&lt;std::vector&lt;long&gt; &gt;&amp; ComputeLoads</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;             ,<span class="keyword">const</span> std::vector&lt;int&gt;&amp;           RefRatios</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;             ,<span class="keywordtype">int</span> nProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>()</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;             ) ;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span><span class="comment">/** convenience function to load balance a std::vector of Boxes based</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">    on load=box.numPts() */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>(std::vector&lt;int&gt;&amp; a_procAssignments, <span class="keyword">const</span> std::vector&lt;Box&gt;&amp; a_boxes,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> a_LBnumProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>());</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span><span class="comment">/** convenience function to load balance a std::vector of Loads based</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">    on load.  boxes also passed in for possible use with box-swapping code */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>(std::vector&lt;int&gt;&amp;             a_procAssignments,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="keyword">const</span> std::vector&lt;long long&gt;&amp; a_computeLoads,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="keyword">const</span> std::vector&lt;Box&gt;&amp;       a_boxes,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>                a_LBnumProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>());</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span><span class="comment">/** Accepts &quot;long int&quot; computeLoads and then just calls the &quot;long long&quot; version. */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>(std::vector&lt;int&gt;&amp;             a_procAssignments,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keyword">const</span> std::vector&lt;long int&gt;&amp;  a_computeLoads,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keyword">const</span> std::vector&lt;Box&gt;&amp;       a_boxes,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>                a_LBnumProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>());</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">   This is experimental and to keep me from doing long long &lt;-&gt; long conversions. (dtg)</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   I think we can remove this as it simply calls the above LoadBalance() (ndk 8.4.2008)</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Chombo__LoadBalance_8H.html#a2166a991f57fcf896da42fe691f167d9">UnLongLongLoadBalance</a>(std::vector&lt;int&gt;&amp;                      a_procAssignments,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                          <span class="keyword">const</span> std::vector&lt;unsigned long long&gt;&amp; a_computeLoads,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                          <span class="keyword">const</span> std::vector&lt;Box&gt;&amp;                a_boxes,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">int</span>                         a_numProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>());</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span><span class="comment">/* Even simpler load balance scheme that just dices vector to give as close to the same number</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">of boxes to each rank.  </span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Chombo__LoadBalance_8H.html#a672152d42dd35de633cd0c2932924e59">basicLoadBalance</a>(std::vector&lt;int&gt;&amp; a_procAssignments, <span class="keywordtype">int</span> numBoxes, <span class="keywordtype">int</span> a_numProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>());</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span><span class="keywordtype">int</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>(std::vector&lt;int&gt;&amp; procAssignments</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            ,<a class="code" href="Chombo__REAL_8H.html#a445a5f0e2a34c9d97d69a3c2d1957907">Real</a>&amp;                 effRatio</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            ,<span class="keyword">const</span> std::vector&lt;Box&gt;&amp;  Grids</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            ,<span class="keyword">const</span> std::vector&lt;long&gt;&amp; ComputeLoads);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/// convenience function to gather a distributed set of Boxes with their corresponding processor assignment</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span><span class="comment">/** Assumption is that each processor has at most one valid box. This is useful when interacting with other distributed codes which might not have the entire set of distributed boxes on all processors.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a>(std::vector&lt;int&gt;&amp; a_procAssignments, </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                std::vector&lt;Box&gt;&amp; a_boxes,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keyword">const</span> <a class="code" href="classBox.html">Box</a>&amp;   a_localGridBox,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>    a_numProc = <a class="code" href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">numProc</a>());</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chombo__NamespaceFooter_8H.html">Chombo_NamespaceFooter.H</a>&quot;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="Chombo__SPMD_8H_html"><div class="ttname"><a href="Chombo__SPMD_8H.html">Chombo_SPMD.H</a></div></div>
<div class="ttc" id="Chombo__LoadBalance_8H_html_a2166a991f57fcf896da42fe691f167d9"><div class="ttname"><a href="Chombo__LoadBalance_8H.html#a2166a991f57fcf896da42fe691f167d9">UnLongLongLoadBalance</a></div><div class="ttdeci">int UnLongLongLoadBalance(std::vector&lt; int &gt; &amp;a_procAssignments, const std::vector&lt; unsigned long long &gt; &amp;a_computeLoads, const std::vector&lt; Box &gt; &amp;a_boxes, const int a_numProc=numProc())</div></div>
<div class="ttc" id="Chombo__REAL_8H_html"><div class="ttname"><a href="Chombo__REAL_8H.html">Chombo_REAL.H</a></div></div>
<div class="ttc" id="Chombo__LoadBalance_8H_html_a672152d42dd35de633cd0c2932924e59"><div class="ttname"><a href="Chombo__LoadBalance_8H.html#a672152d42dd35de633cd0c2932924e59">basicLoadBalance</a></div><div class="ttdeci">int basicLoadBalance(std::vector&lt; int &gt; &amp;a_procAssignments, int numBoxes, int a_numProc=numProc())</div></div>
<div class="ttc" id="Chombo__BoxLayout_8H_html"><div class="ttname"><a href="Chombo__BoxLayout_8H.html">Chombo_BoxLayout.H</a></div></div>
<div class="ttc" id="Chombo__NamespaceHeader_8H_html"><div class="ttname"><a href="Chombo__NamespaceHeader_8H.html">Chombo_NamespaceHeader.H</a></div></div>
<div class="ttc" id="Chombo__REAL_8H_html_a445a5f0e2a34c9d97d69a3c2d1957907"><div class="ttname"><a href="Chombo__REAL_8H.html#a445a5f0e2a34c9d97d69a3c2d1957907">Real</a></div><div class="ttdeci">double Real</div><div class="ttdef"><b>Definition:</b> Chombo_REAL.H:22</div></div>
<div class="ttc" id="namespaceCH4__SPMD_html_afd470e87652341487efd3cb4de341470"><div class="ttname"><a href="namespaceCH4__SPMD.html#afd470e87652341487efd3cb4de341470">CH4_SPMD::numProc</a></div><div class="ttdeci">unsigned int numProc()</div><div class="ttdoc">number of parallel processes </div></div>
<div class="ttc" id="Chombo__NamespaceFooter_8H_html"><div class="ttname"><a href="Chombo__NamespaceFooter_8H.html">Chombo_NamespaceFooter.H</a></div></div>
<div class="ttc" id="Chombo__Box_8H_html"><div class="ttname"><a href="Chombo__Box_8H.html">Chombo_Box.H</a></div></div>
<div class="ttc" id="Chombo__LoadBalance_8H_html_a3f4a3dd5a019c14d3a06fa03609eae55"><div class="ttname"><a href="Chombo__LoadBalance_8H.html#a3f4a3dd5a019c14d3a06fa03609eae55">LoadBalance</a></div><div class="ttdeci">int LoadBalance(std::vector&lt; std::vector&lt; int &gt; &gt; &amp;a_procAssignments, Real &amp;a_effRatio, const std::vector&lt; std::vector&lt; Box &gt; &gt; &amp;a_Grids, const std::vector&lt; std::vector&lt; long &gt; &gt; &amp;a_ComputeLoads, const std::vector&lt; int &gt; &amp;a_RefRatios, int a_nProc=numProc())</div></div>
<div class="ttc" id="classBox_html"><div class="ttname"><a href="classBox.html">Box</a></div><div class="ttdoc">A Rectangular Domain on an Integer Lattice. </div><div class="ttdef"><b>Definition:</b> Chombo_Box.H:451</div></div>
<div class="ttc" id="Chombo__SPACE_8H_html"><div class="ttname"><a href="Chombo__SPACE_8H.html">Chombo_SPACE.H</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
